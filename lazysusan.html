<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PX-Δ1 // LIVE INTELLIGENCE</title>
    <style>
        /* --- MILITARY TERMINAL THEME --- */
        :root {
            --term-green: #00ff33;
            --term-dim: #004411;
            --term-alert: #ff3300;
            --term-bg: #000000;
            --font-stack: 'Consolas', 'Monaco', 'Courier New', monospace;
        }

        body {
            background-color: var(--term-bg);
            color: var(--term-green);
            font-family: var(--font-stack);
            font-size: 11px;
            margin: 0;
            padding: 0;
            height: 100dvh; /* Dynamic viewport height fix */
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* HEADER */
        #top-bar {
            height: 40px; flex-shrink: 0;
            border-bottom: 1px solid var(--term-green);
            padding: 0 10px; display: flex; justify-content: space-between; align-items: center;
            background: #050505; z-index: 10; font-weight: bold; letter-spacing: 1px;
        }

        /* MAIN GRID */
        #main-grid { display: flex; flex: 1; overflow: hidden; position: relative; }

        /* COL 1: RAW HEX (The Matrix) */
        #col-raw {
            width: 60px; flex-shrink: 0;
            border-right: 1px solid var(--term-dim); padding: 5px;
            overflow: hidden; opacity: 0.6; font-size: 9px; line-height: 1;
            white-space: pre; color: var(--term-dim); user-select: none;
        }

        /* COL 2: INTELLIGENCE FEED */
        #col-main {
            flex: 1; padding: 15px; overflow-y: auto;
            display: flex; flex-direction: column;
            background: radial-gradient(circle at center, #051105 0%, #000000 120%);
        }
        #col-main::-webkit-scrollbar { width: 4px; }
        #col-main::-webkit-scrollbar-thumb { background: var(--term-green); }

        /* STATUS SIDEBAR (Desktop/Tablet only, hidden on small mobile to save space) */
        #col-stat {
            width: 120px; border-left: 1px solid var(--term-dim);
            padding: 10px; display: flex; flex-direction: column; gap: 15px;
            background: #020202;
        }
        @media (max-width: 600px) { #col-stat { display: none; } }

        /* CONTROLS (Bottom) */
        #controls {
            background: #000; border-top: 1px solid var(--term-green);
            padding: 10px; padding-bottom: max(10px, env(safe-area-inset-bottom)); /* iPhone fix */
            display: flex; flex-direction: column; gap: 10px;
        }

        /* CHIPS */
        #chip-rack {
            display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px;
        }
        .chip {
            background: #111; border: 1px solid #333; color: #888; padding: 8px 12px;
            font-size: 10px; text-transform: uppercase; cursor: pointer; white-space: nowrap;
        }
        .chip:hover { border-color: var(--term-green); color: #fff; background: #0a2a0a; }

        /* INPUT */
        .input-row {
            display: flex; align-items: center; border: 1px solid #333; background: #080808; padding: 10px;
        }
        input {
            background: transparent; border: none; color: #fff; flex: 1;
            font-family: inherit; font-size: 14px; outline: none; text-transform: uppercase;
        }

        /* VISUAL ELEMENTS */
        .log-line { margin-bottom: 6px; word-wrap: break-word; }
        .sys { color: #448844; }
        .user { color: #fff; font-weight: bold; margin-top: 10px; }
        .ai-response { color: var(--term-green); margin-top: 5px; line-height: 1.5; }
        
        /* AI REPORT BOX STYLE */
        .report-box {
            border: 1px solid var(--term-green); background: rgba(0,255,51,0.03);
            padding: 15px; margin: 10px 0; position: relative;
            animation: fadeIn 0.5s;
        }
        .report-header {
            border-bottom: 1px dashed var(--term-dim); margin-bottom: 8px; padding-bottom: 5px;
            font-weight: bold; display: flex; justify-content: space-between;
        }
        
        .typing-cursor::after { content: '█'; animation: blink 1s infinite; }
        @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }
        @keyframes fadeIn { from{opacity:0} to{opacity:1} }

        .stat-box { border: 1px solid #222; padding: 5px; }
        .stat-label { font-size: 8px; color: #666; display: block; }
        .stat-val { font-size: 12px; font-weight: bold; color: #fff; }

    </style>
</head>
<body>

<div id="top-bar">
    <span>PX-Δ1 // LIVE_UPLINK</span>
    <span style="font-size:9px">GEMINI-1.5-FLASH <span style="color:var(--term-alert)">●</span></span>
</div>

<div id="main-grid">
    <div id="col-raw"></div>

    <div id="col-main">
        <div class="log-line sys">INITIALIZING NEURAL BRIDGE...</div>
        <div class="log-line sys">API HANDSHAKE: SECURE</div>
        <div class="log-line sys">READY FOR GLOBAL QUERIES.</div>
    </div>

    <div id="col-stat">
        <div class="stat-box">
            <span class="stat-label">NET_LOAD</span>
            <span class="stat-val" id="net-val">0 TB/s</span>
        </div>
        <div class="stat-box">
            <span class="stat-label">ACTIVE NODES</span>
            <span class="stat-val">14,205</span>
        </div>
        <div class="stat-box">
            <span class="stat-label">THREAT LEVEL</span>
            <span class="stat-val" style="color:var(--term-alert)">CRITICAL</span>
        </div>
    </div>
</div>

<div id="controls">
    <div id="chip-rack">
        <div class="chip" onclick="askAI('ANALYZE USA')">USA</div>
        <div class="chip" onclick="askAI('ANALYZE CHINA')">CHINA</div>
        <div class="chip" onclick="askAI('ANALYZE RUSSIA')">RUSSIA</div>
        <div class="chip" onclick="askAI('ANALYZE SAUDI ARABIA')">SAUDI</div>
        <div class="chip" onclick="askAI('ANALYZE DUBAI STRATEGY')">DUBAI</div>
        <div class="chip" onclick="askAI('ANALYZE MARS COLONY')">MARS</div>
        <div class="chip" onclick="askAI('ASSESS WATER CRISIS')">WATER</div>
        <div class="chip" onclick="askAI('ASSESS AI GOVERNANCE')">AI GOV</div>
        <div class="chip" onclick="askAI('ASSESS BITCOIN STRATEGY')">CRYPTO</div>
    </div>
    <div class="input-row">
        <span style="color:var(--term-green); margin-right:10px;">CMD:~$</span>
        <input type="text" id="user-input" placeholder="ENTER TARGET (E.G. 'ESTONIA ENERGY')..." autofocus>
    </div>
</div>

<script>
    /* ==========================================
       CONFIGURATION - PANE OMA API VÕTI SIIA!
       ========================================== */
    const API_KEY = "AIzaSyAXELeZWjjAkZS4bDzPrNFEfz9t0CpKGB8"; 
    
    // See on Kryonise "Aju" seadistus. See sunnib Gemini rääkima nagu sõjaväearvuti.
    const SYSTEM_PROMPT = `
    You are PX-Δ1, a Sovereign Global Monitoring AI used by Kryonis.
    Your output must be a STRATEGIC INTELLIGENCE REPORT.
    Style: Military, Cryptic, High-Level, No polite filler words.
    
    Format structure:
    1. HEADER: [TARGET] SIGNAL REPORT (Date: Realtime)
    2. RISK LEVEL: (Low/Medium/Critical)
    3. SECTOR ANALYSIS:
       - GOVERNANCE: (Analyze political/sovereign moves)
       - LOGISTICS/ECONOMY: (Analyze resources/trade)
       - COGNITIVE: (Analyze social sentiment/control)
    4. STRATEGIC DOCTRINE: (A short, punchy conclusion phrase)

    If the topic is fictional (like Mars Colony), treat it as real and happening now.
    Keep it under 150 words. Use <br> for line breaks and <b> for emphasis.
    `;

    /* ==========================================
       VISUAL ENGINE
       ========================================== */
    const rawCol = document.getElementById('col-raw');
    const mainCol = document.getElementById('col-main');
    const input = document.getElementById('user-input');
    const netVal = document.getElementById('net-val');

    // Hex Matrix Effect
    function matrixRain() {
        let text = "";
        const chars = "01";
        for (let i=0; i<150; i++) {
            text += chars.charAt(Math.floor(Math.random() * chars.length));
            if (i%2===0) text += " ";
            if (i%6===0) text += "\n";
        }
        rawCol.innerText = text;
        netVal.innerText = Math.floor(Math.random() * 900 + 100) + " TB/s";
    }
    setInterval(matrixRain, 80);

    // Helper to add lines
    function addLog(text, type) {
        const div = document.createElement('div');
        div.className = "log-line " + type;
        div.innerHTML = text;
        mainCol.appendChild(div);
        mainCol.scrollTop = mainCol.scrollHeight;
        return div;
    }

    /* ==========================================
       AI LOGIC (GEMINI API)
       ========================================== */
    async function callGemini(query) {
        // 1. User UI Feedback
        input.disabled = true;
        addLog(`> UPLINK REQUEST: ${query}`, 'user');
        const loadingLine = addLog("SCANNING GLOBAL DATASETS...", 'sys');
        
        // 2. Fake processing delay (for impact)
        await new Promise(r => setTimeout(r, 1000));
        loadingLine.innerText = "DECRYPTING STRATEGIC ARCHIVES...";
        await new Promise(r => setTimeout(r, 800));
        loadingLine.innerText = "SYNTHESIZING INTELLIGENCE...";

        try {
            // 3. Real API Call
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{
                        parts: [{ text: SYSTEM_PROMPT + "\n\nQUERY: " + query }]
                    }]
                })
            });

            const data = await response.json();
            
            // 4. Parse Response
            if (data.candidates && data.candidates.length > 0) {
                const aiText = data.candidates[0].content.parts[0].text;
                loadingLine.style.display = 'none'; // Hide loading text
                
                // Typewriter Effect for the report
                const reportDiv = document.createElement('div');
                reportDiv.className = 'report-box';
                mainCol.appendChild(reportDiv);
                
                // Simple HTML rendering
                reportDiv.innerHTML = aiText; 
                mainCol.scrollTop = mainCol.scrollHeight;
            } else {
                loadingLine.innerText = "ERROR: SECURE CONNECTION FAILED.";
                loadingLine.style.color = "red";
            }

        } catch (error) {
            console.error(error);
            loadingLine.innerText = "CRITICAL ERROR: API UNREACHABLE.";
            loadingLine.style.color = "red";
        }

        input.disabled = false;
        input.value = '';
        input.focus();
    }

    function askAI(q) { callGemini(q); }

    input.addEventListener('keypress', (e) => {
        if(e.key === 'Enter') {
            const val = input.value.trim().toUpperCase();
            if(val) callGemini(val);
        }
    });

</script>
</body>
</html>
